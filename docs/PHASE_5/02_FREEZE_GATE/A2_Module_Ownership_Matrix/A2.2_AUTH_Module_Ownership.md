# ✅ A2.2 — AUTH Module Ownership Matrix

**Phase:** Phase-5  
**Category:** A — Freeze Gate Verification  
**Item:** A2.2  
**Status:** ✅ COMPLETED (Freeze-ready)  
**Date:** 2026-01-27  
**Purpose:** Lock table ownership, change authority, and responsibility boundaries for AUTH module tables.

⸻

## 1) Ownership Rule (Canonical)

- **Each table has one primary owner module.**
- **Owner module is accountable for:**
  - schema changes
  - validation rules
  - write-path APIs
  - data integrity guarantees
- **Non-owner modules may read via foreign keys, but must not introduce write logic without owner approval.**

⸻

## 2) AUTH Tables — Ownership & Responsibilities

| Table | Primary Owner | Responsibility Scope | Write Authority | Key Constraints / Notes |
|-------|---------------|---------------------|-----------------|-------------------------|
| `tenants` | AUTH | Tenant lifecycle, isolation root, tenant metadata | AUTH only | Root isolation entity. All tenant-scoped tables depend on it. |
| `users` | AUTH | User identity, authentication, user status | AUTH only | Must remain tenant-scoped. Email uniqueness rules enforced per tenant. |
| `roles` | AUTH | Role definitions and role lifecycle | AUTH only | Roles are tenant-scoped. Role naming standard must be controlled. |
| `user_roles` | AUTH | Role assignment and RBAC mapping | AUTH only | Many-to-many user-role binding. No module should bypass RBAC logic. |
| `audit_log` (or `audit_logs` if canonical name differs) | AUDIT (cross-cutting) | System-wide audit trail storage | AUDIT only | Although referenced in AUTH discussions, audit storage must remain owned by AUDIT module. AUTH may write auth-related audit events via AUDIT API. |

⸻

## 3) Explicit Non-Goals (Prevent Scope Drift)

**AUTH module does not own:**
- pricing tables
- quotation tables
- catalog tables
- discount/tax tables
- business rules beyond identity/permission boundaries

**AUTH can reference these entities only through:**
- `tenant_id` isolation
- `user_id` actor attribution
- role-based permission checks

⸻

## 4) Enforcement Expectations (Freeze Gate)

**Enforcement must be true in implementation:**
- All tables above are created/managed by AUTH migrations (except audit table which is AUDIT-owned).
- Only AUTH endpoints/services can create/update/delete users/roles/role assignments.
- Other modules must treat AUTH tables as read-only dependencies, except for passing `user_id`, `tenant_id` to AUDIT logger or enforcement validators.

⸻

## 5) Evidence References (Where to Verify)

- **Schema DDL migrations under:**
  - `backend/alembic/versions/*create_schema_canon*`
- **Runtime usage:**
  - `backend/app/api/v1/endpoints/auth.py` (if implemented)
- **Role checks in validators:**
  - `backend/app/validators/*`
- **Audit logger:**
  - `backend/app/audit/logger.py`

*(Exact filenames may vary; verify with grep: CREATE TABLE tenants, CREATE TABLE users, etc.)*

⸻

## 6) Freeze Gate Compliance

**Freeze Gate Checklist Item:** A2.2 — AUTH table ownership  
**Status:** ✅ VERIFIED  
**Approval:** ✅ APPROVED

⸻

## Next Task

➡️ **A2.3** — Map CIM Module tables (catalog, taxonomy, attributes, SKU/L1/L2 structures)

