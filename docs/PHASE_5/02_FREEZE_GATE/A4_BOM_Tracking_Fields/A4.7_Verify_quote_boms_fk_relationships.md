# A4.7 — Verify quote_boms FK relationships are correct

**Phase:** Phase-5  
**Category:** A — Freeze Gate Verification  
**Item:** A4.7  
**Status:** ✅ VERIFIED  
**Date:** 2026-01-27  
**Purpose:** Confirm FK integrity for workspace hierarchy + provenance + attribution.

## Evidence
- **Migration file:** `backend/alembic/versions/20260104_110400_create_schema_canon_v1_0_l1_l2_quo_pricing.py`
- **How to locate:** inside `create_table('quote_boms'` locate `sa.ForeignKeyConstraint(...)` lines

## Findings (FKs present)
- ✅ `tenant_id` → `tenants.id` (ondelete `CASCADE`)
- ✅ `quotation_id` → `quotations.id` (ondelete `CASCADE`)
- ✅ `panel_id` → `quote_panels.id` (ondelete `CASCADE`)
- ✅ `parent_bom_id` → `quote_boms.id` (ondelete `CASCADE`) (hierarchy)
- ✅ `origin_master_bom_id` → `master_boms.id` (ondelete `SET NULL`) (provenance reference-only)
- ✅ `modified_by` → `users.id` (ondelete `SET NULL`) (actor attribution)

## Conclusion
- Freeze gate decision: ✅ APPROVED
- Notes: On-delete policies are aligned with copy-never-link and safe lifecycle handling.

