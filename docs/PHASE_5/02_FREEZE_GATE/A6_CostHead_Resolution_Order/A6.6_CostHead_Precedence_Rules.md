# A6.6 — CostHead Precedence Rules (Edge Cases)

**Phase:** Phase-5  
**Category:** A — Freeze Gate Verification  
**Item:** A6.6  
**Status:** ✅ LOCKED (Freeze-ready)  
**Date:** 2026-01-27  
**Purpose:** Prevent ambiguity in CostHead resolution by documenting edge cases.

⸻

## Rules (LOCKED)

### R1 — Line override always wins
If `quote_bom_items.cost_head_id` is set, it must override any product-level default.

### R2 — Product default requires product_id context
If `product_id` is NULL (L0/L1), product default cannot be used; proceed to system default/NULL.

### R3 — Resolution independent of pricing
Even if a line has `rate_source = UNRESOLVED` or `is_price_missing = true`, CostHead resolution still applies.

### R4 — Deactivated CostHeads
If a referenced CostHead is inactive:
- Existing stored references remain valid historically.
- UI should block new selection of inactive CostHeads.
- System default (if used) must be active.

### R5 — System default behavior
If the system default CostHead is not explicitly defined in schema/rules:
- NULL is allowed as final fallback
- UI must prompt user to assign a CostHead for reporting completeness.

⸻

## Change Control

These rules are **LOCKED** and cannot be changed without:
1) explicit Senate decision update,  
2) Data Dictionary update,  
3) Schema Canon note (if schema changes),  
4) Freeze gate checklist update.

