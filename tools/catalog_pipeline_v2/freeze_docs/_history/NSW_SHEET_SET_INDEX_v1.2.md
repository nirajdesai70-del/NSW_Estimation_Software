**Generated By:** scripts/apply_phase3_fixes.py  
**Generated On:** 2026-01-03 00:08:16  
**Source:** v1 files (unchanged)  

---

# NSW Sheet Set Index v1

**Status:** FINAL (v1.2) – AUTHORITATIVE  
**Scope:** SKU + Price Creation Pack (with minimal L0/L1 for catalog chain continuity)  
**Aligned With:** NSW Master Doctrine v2.0 + Terminology Freeze v1  
**Last Reviewed:** 2025-01-XX

---

## 1) Purpose of this Index

This file defines:
- Which sheets/files are **ACTIVE** and authoritative
- Which sheets are **REFERENCE / LEGACY**
- Which sheets are **ARCHIVE-READY**
- What each sheet is used for
- What must never be edited or reused for new work

This prevents accidental misuse while working in Cursor or during imports.

---

## 2) Terminology Reminder (Applies Everywhere)

- **Business Category / Business Segment** → classification only
- **Item / L0 / L1 / L2** → engineering + pricing
- **Capability / Feature** → engineering options (not business)

**(Ref: `NSW_TERMINOLOGY_AND_LEVELS_FREEZE_v1.md`)**

---


### Engineering Bank Mapping Table (Authoritative)

| Cursor/Pipeline Sheet | Engineering Bank Sheet | Notes |
|----------------------|------------------------|-------|
| NSW_SKU_MASTER_CANONICAL | DATA_SKU_PRICE_LIST | L2 SKU identity |
| NSW_ACCESSORY_SKU_MASTER | DATA_ACCESSORY_PRICE_LIST | Accessory SKU list |
| NSW_CATALOG_CHAIN_MASTER | DATA_ITEM_MASTER | Layer-1 minimal intent |
| NSW_PRICE_MATRIX_CANONICAL | PRICE_MATRIX | Commercial layer |

Note: Engineering Bank naming is authoritative for AI-assisted catalog work.


## 3) ACTIVE – Authoritative Sheets (DO NOT DUPLICATE)

These sheets define the current truth and must be used for all new work.

### 3.1 SKU & Price Core (Primary)

| Sheet / File | Status | Purpose | Current Name in Code |
|--------------|--------|---------|---------------------|
| `NSW_SKU_MASTER_CANONICAL` | ACTIVE | L2 SKU identity (make-specific, no price logic here) | `NSW_L2_PRODUCTS` |
| `NSW_PRICE_MATRIX_CANONICAL` | ACTIVE | Only source of price truth (SKU-only, versioned) | `NSW_PRICE_MATRIX` |
| `NSW_PRICE_MATRIX_QC` | ACTIVE | Price coverage & missing-price checks | (to be created) |

**Rules:**
- Price must never be stored outside Price Matrix
- SKU is the atomic priced object

**Current Implementation:**
- ✅ `NSW_L2_PRODUCTS` - Generated by `build_nsw_workbook_from_canonical.py`
- ✅ `NSW_PRICE_MATRIX` - Generated by `build_nsw_workbook_from_canonical.py`
- ⚠️ `NSW_PRICE_MATRIX_QC` - Not yet generated (recommended addition)

**Note:** `NSW_L2_PRODUCTS` and `NSW_SKU_MASTER_CANONICAL` are the same concept. Both names are acceptable during transition.

---

### 3.2 Catalog Chain (Minimal L0/L1 continuity)

| Sheet | Status | Purpose | Current Name in Code |
|-------|--------|---------|---------------------|
| `NSW_CATALOG_CHAIN_MASTER` | ACTIVE | Single master chain holding L0/L1/L2 relationships for catalog continuity | `NSW_L1_CONFIG_LINES` (different concept) |

**Contains:**
- Business Category
- Business Segment
- Item/ProductType
- L0 (generic intent)
- L1 (generic spec – numeric, make-agnostic)
- L2 SKU link

**Rules:**
- No OEM series (LC1E etc.) in L0/L1
- No price in this sheet
- This sheet replaces all legacy L1 parse sheets

**Current Implementation:**
- ⚠️ `NSW_L1_CONFIG_LINES` - Currently generated, but different concept
- ⚠️ `NSW_CATALOG_CHAIN_MASTER` - Not yet generated (recommended new sheet)

**Note:** `NSW_L1_CONFIG_LINES` contains L1 configuration lines (duty × voltage expansion). `NSW_CATALOG_CHAIN_MASTER` would be a unified chain. Both may be needed, or `NSW_L1_CONFIG_LINES` may be renamed/refactored.

---

### 3.3 Variants & Selection (Active)

| Sheet | Status | Purpose | Current Name in Code |
|-------|--------|---------|---------------------|
| `NSW_VARIANT_MASTER` | ACTIVE | Variant definitions (voltage codes, duty codes) | `NSW_VARIANT_MASTER` |
| `NSW_PRODUCT_VARIANTS` | ACTIVE | L2→variant allowed mappings | `NSW_PRODUCT_VARIANTS` |

**Current Implementation:**
- ✅ `NSW_VARIANT_MASTER` - Generated by `build_nsw_workbook_from_canonical.py`
- ✅ `NSW_PRODUCT_VARIANTS` - Generated by `build_nsw_workbook_from_canonical.py`

---

### 3.4 Ratings (Reference, but authoritative)

| Sheet | Status | Purpose | Current Name in Code |
|-------|--------|---------|---------------------|
| `NSW_SKU_RATINGS` | ACTIVE (REFERENCE) | OEM-specific ratings (AC1/AC3, kA, kW, etc.) tied to SKU | (not yet generated) |

**Rules:**
- Ratings may vary by make
- Ratings do not define L1 identity
- Ratings do not drive price directly

**Current Implementation:**
- ❌ `NSW_SKU_RATINGS` - Not yet generated (recommended addition)

---

### 3.5 Accessories (L2, commercial)

| Sheet | Status | Purpose | Current Name in Code |
|-------|--------|---------|---------------------|
| `NSW_ACCESSORY_SKU_MASTER` | ACTIVE | Standalone accessory SKUs (priced separately) | Part of `NSW_L1_CONFIG_LINES` (FEATURE lines) |

**Rules:**
- Accessories are not Item/ProductType
- Accessories may later map to Feature Lines in estimation layer

**Current Implementation:**
- ⚠️ Accessories currently in `NSW_L1_CONFIG_LINES` as FEATURE lines
- ⚠️ `NSW_ACCESSORY_SKU_MASTER` - Not yet generated as separate sheet (recommended extraction)

---

## 4) DICTIONARIES – Locked Reference Sheets

These sheets exist to standardize meaning.
They are not transactional, but should not be modified casually.

| Sheet | Status | Purpose | Current Name in Code |
|-------|--------|---------|---------------------|
| `NSW_SC_DICTIONARY` | LOCKED | Capability class definitions (formerly SC_Lx) | (not yet generated) |
| `NSW_ATTR_DICTIONARY` | LOCKED | Attribute KVU definitions | (not yet generated) |
| `NSW_RATING_DICTIONARY` | LOCKED | Rating definitions & units | (not yet generated) |

**Current Implementation:**
- ❌ Dictionary sheets not yet generated (recommended addition)

---

## 5) REFERENCE / LEGACY (READ-ONLY)

These sheets were used for parsing, extraction, or migration.

| Sheet | Status | Rule | Current Location |
|-------|--------|------|------------------|
| `NSW_L1_CONFIG_LINES` | LEGACY | Do not edit; source parse only | Generated by `build_nsw_workbook_from_canonical.py` |
| `NSW_L1_CONFIG_LINES_CANONICAL` | LEGACY | Superseded by Catalog Chain Master | (archived) |
| `NSW_L2_PRODUCTS` (if superseded) | LEGACY | SKU list migrated to SKU Master | Generated by `build_nsw_workbook_from_canonical.py` |
| `NSW_VARIANT_MASTER` | ACTIVE | Variant decoding reference | Generated by `build_nsw_workbook_from_canonical.py` |
| `NSW_ACCESSORY_MASTER` | LEGACY | Price fallback source (now resolved) | (archived) |
| Any `LC1E_*` helper sheets | LEGACY | One-time extraction helpers | `archives/schneider/LC1E/` |

**Rule:**
- Legacy sheets must not be used for new entries
- Legacy sheets must not be copied forward

**Note:** `NSW_L1_CONFIG_LINES` is currently generated and used. It may be:
1. Kept as active (if it serves a different purpose than `NSW_CATALOG_CHAIN_MASTER`)
2. Renamed/refactored to `NSW_CATALOG_CHAIN_MASTER`
3. Marked as legacy if superseded

**Decision Required:** Clarify relationship between `NSW_L1_CONFIG_LINES` and `NSW_CATALOG_CHAIN_MASTER`.

---

## 6) ARCHIVE-READY (After Final Check)

Once the following are confirmed:
- ✅ SKU Master complete
- ✅ Price Matrix QC clean
- ✅ Catalog Chain Master verified

Then these may be archived (zip / move out of active folder):

### 6.1 Archive Candidates

**Location:** `tools/catalog_pipeline_v2/archives/schneider/LC1E/2025-07-15_WEF/`

**Ready to Archive:**
- `00_inputs/` - Source files (already in archive)
- `01_scripts/` - Legacy extraction scripts
- `02_outputs/rebuild_check/` - Rebuild test files (14 files)
- `03_qc/` - QC documentation (reference only)
- `04_docs/` - Documentation (reference only)

**Needs Review:**
- `02_outputs/NSW_MASTER_SCHNEIDER_WEF_2025-07-15_ENGINEER_REVIEW.xlsx` - Verify superseded
- `02_outputs/LC1E_CANONICAL_v1.xlsx` - Verify in active location
- `02_outputs/LC1E_ENGINEER_REVIEW_v1.xlsx` - Verify superseded

**Keep Active:**
- `active/schneider/LC1E/` - Current active work
- `input/schneider/lc1e/` - Source files
- `scripts/build_nsw_workbook_from_canonical.py` - Active pipeline

---

## 7) What This Workbook Is NOT

This workbook is **NOT:**
- The NSW estimation engine
- The feature explosion logic
- The L1 feature-line implementation
- The BOM / quotation runtime model

Those belong to later Phase-5 artifacts.

---

## 8) Safe Workflow Going Forward

1. **Add SKUs** → `NSW_L2_PRODUCTS` (or `NSW_SKU_MASTER_CANONICAL`)
2. **Import prices** → `NSW_PRICE_MATRIX` (or `NSW_PRICE_MATRIX_CANONICAL`)
3. **Add ratings (if needed)** → `NSW_SKU_RATINGS` (to be created)
4. **Link to catalog intent** → `NSW_L1_CONFIG_LINES` (or `NSW_CATALOG_CHAIN_MASTER`)
5. **Never edit legacy sheets**

---

## 9) Sheet Name Mapping

### Current → Proposed (During Transition)

| Current Name | Proposed Name | Status | Action |
|--------------|---------------|--------|--------|
| `NSW_L2_PRODUCTS` | `NSW_SKU_MASTER_CANONICAL` | ✅ Same concept | Support both names |
| `NSW_PRICE_MATRIX` | `NSW_PRICE_MATRIX_CANONICAL` | ✅ Same concept | Support both names |
| `NSW_L1_CONFIG_LINES` | `NSW_CATALOG_CHAIN_MASTER` | ⚠️ Different concepts | Need clarification |
| (not generated) | `NSW_SKU_RATINGS` | ❌ New sheet | Create new |
| (in L1_CONFIG) | `NSW_ACCESSORY_SKU_MASTER` | ⚠️ Extract needed | Extract to separate |

**Recommendation:** Support both current and proposed names during transition period.

---

## 10) Freeze Statement

This index is **authoritative** for deciding:
- what to edit
- what to read
- what to archive

Any work done outside this index is considered non-canonical.

---

## 11) Next Logical Steps (When Ready)

- ✅ Apply the same structure to remaining contactor SKUs
- ✅ Then onboard MCCB / ACB using the same pattern
- ✅ Later: derive estimation-layer artifacts from this clean base

**If you want, next we can:**
- Validate `NSW_CATALOG_CHAIN_MASTER` row-by-row, or
- Start MCCB onboarding using this frozen index

---

## 12) References

- `NSW_TERMINOLOGY_AND_LEVELS_FREEZE_v1.md` - Terminology definitions
- `FREEZE_DOCUMENTS_REVIEW.md` - Review and assessment
- `NSW Fundamental Alignment Plan/01_FUNDAMENTALS/MASTER_FUNDAMENTALS_v2.0.md` - Master fundamentals

---

**END OF DOCUMENT**



### Decision CLOSED (Catalog Chain)

- NSW_CATALOG_CHAIN_MASTER is canonical for continuity.
- NSW_L1_CONFIG_LINES is legacy parse output and becomes archive-ready after chain verification QC.

### Alias Support During Transition

- business_subcategory is a legacy alias for business_segment
- SC_Lx are structural (SCL), not capability_class
