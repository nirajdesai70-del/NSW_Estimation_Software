#!/usr/bin/env bash
set -euo pipefail

# Run pre-commit hooks configured for the commit-msg stage.
# This repo uses core.hooksPath=.githooks (do not use `pre-commit install`).

PYTHON_BIN="${PYTHON_BIN:-python3}"

if command -v "$PYTHON_BIN" >/dev/null 2>&1; then
  exec "$PYTHON_BIN" -m pre_commit run --hook-stage commit-msg --commit-msg-filename "${1:-.git/COMMIT_EDITMSG}"
fi

if command -v python >/dev/null 2>&1; then
  exec python -m pre_commit run --hook-stage commit-msg --commit-msg-filename "${1:-.git/COMMIT_EDITMSG}"
fi

echo "commit-msg: python not found; cannot run pre_commit hooks."
echo "tip: pip install pre-commit && pre-commit --version"
exit 1

